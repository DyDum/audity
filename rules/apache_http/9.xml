<RulesCIS>
  <Rule id="9.1">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>TimeOut directive is set higher than 10 seconds.</NonCompliantComment>
    <CorrectiveComment>Set TimeOut to 10 or less.</CorrectiveComment>
    <Correction>sed -i 's/^TimeOut .*/TimeOut 10/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^TimeOut 10" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="9.2">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>KeepAlive is not enabled.</NonCompliantComment>
    <CorrectiveComment>Enable KeepAlive in the Apache configuration.</CorrectiveComment>
    <Correction>sed -i 's/^#KeepAlive On/KeepAlive On/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^KeepAlive On" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="9.3">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>MaxKeepAliveRequests is set lower than 100.</NonCompliantComment>
    <CorrectiveComment>Set MaxKeepAliveRequests to 100 or greater.</CorrectiveComment>
    <Correction>sed -i 's/^MaxKeepAliveRequests .*/MaxKeepAliveRequests 100/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^MaxKeepAliveRequests 100" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="9.4">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>KeepAliveTimeout is set higher than 15 seconds.</NonCompliantComment>
    <CorrectiveComment>Set KeepAliveTimeout to 15 or less.</CorrectiveComment>
    <Correction>sed -i 's/^KeepAliveTimeout .*/KeepAliveTimeout 15/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^KeepAliveTimeout 15" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="9.5">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>Timeout limits for request headers are set higher than 40 seconds.</NonCompliantComment>
    <CorrectiveComment>Set request header timeout to 40 seconds or less using mod_reqtimeout.</CorrectiveComment>
    <Correction>echo "RequestReadTimeout header=40" >> /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "RequestReadTimeout header=40" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="9.6">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>Timeout limits for the request body are set higher than 20 seconds.</NonCompliantComment>
    <CorrectiveComment>Set request body timeout to 20 seconds or less using mod_reqtimeout.</CorrectiveComment>
    <Correction>echo "RequestReadTimeout body=20" >> /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "RequestReadTimeout body=20" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
</RulesCIS>
