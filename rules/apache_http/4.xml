<RulesCIS>
  <Rule id="4.1">
    <Name>Ensure OS root directory access is denied by default (Automated)</Name>
    <Chapter id="4">Access Control</Chapter>
    <Section id="4.1">Directory Access Restrictions</Section>
    <SubSection id="4.1.1">Root Directory Access</SubSection>

    <Profiles>
      <Profile level="1" type="Server"/>
    </Profiles>
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>Access to OS root directory is not denied by default.</NonCompliantComment>
    <CorrectiveComment>Add a Directory directive for "/" with "Require all denied".</CorrectiveComment>
    <Correction>echo "&lt;Directory /&gt;&lt;Require all denied&gt;&lt;/Require all denied&gt;&lt;/Directory&gt;" &gt;&gt; /etc/httpd/conf/httpd.conf</Correction>
    <Verification>grep -q "&lt;Directory /&gt;" /etc/httpd/conf/httpd.conf &amp;&amp; grep -q "Require all denied" /etc/httpd/conf/httpd.conf &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="4.2">
    <Name>Ensure web content directories have proper access controls (Manual)</Name>
    <Chapter id="4">Access Control</Chapter>
    <Section id="4.1">Directory Access Restrictions</Section>
    <SubSection id="4.1.2">Web Content Directories</SubSection>

    <Profiles>
      <Profile level="1" type="Server"/>
    </Profiles>
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>Access to web content is not properly restricted.</NonCompliantComment>
    <CorrectiveComment>Manually configure appropriate Directory directives with proper access controls for web content.</CorrectiveComment>
    <Correction>Manual review required; update Directory directives with appropriate "Require" statements.</Correction>
    <Verification>Manual verification required</Verification>
    <Manual>YES</Manual>
  </Rule>

  <Rule id="4.3">
    <Name>Ensure AllowOverride is set to None for root directory (Automated)</Name>
    <Chapter id="4">Access Control</Chapter>
    <Section id="4.1">Directory Access Restrictions</Section>
    <SubSection id="4.1.3">AllowOverride for Root Directory</SubSection>

    <Profiles>
      <Profile level="1" type="Server"/>
    </Profiles>
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>AllowOverride is not set to "None" for the OS root directory.</NonCompliantComment>
    <CorrectiveComment>Set AllowOverride to "None" for the root directory in the Apache configuration.</CorrectiveComment>
    <Correction>sed -i 's/AllowOverride .*/AllowOverride None/' /etc/httpd/conf/httpd.conf</Correction>
    <Verification>grep -q "AllowOverride None" /etc/httpd/conf/httpd.conf &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="4.4">
    <Name>Ensure AllowOverride is set to None for all directories (Automated)</Name>
    <Chapter id="4">Access Control</Chapter>
    <Section id="4.1">Directory Access Restrictions</Section>
    <SubSection id="4.1.4">AllowOverride Global</SubSection>

    <Profiles>
      <Profile level="1" type="Server"/>
    </Profiles>
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>One or more directories have AllowOverride enabled.</NonCompliantComment>
    <CorrectiveComment>Set AllowOverride to "None" for all directories in the Apache configuration.</CorrectiveComment>
    <Correction>sed -i 's/AllowOverride .*/AllowOverride None/g' /etc/httpd/conf/httpd.conf</Correction>
    <Verification>grep -q "AllowOverride None" /etc/httpd/conf/httpd.conf &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
</RulesCIS>
