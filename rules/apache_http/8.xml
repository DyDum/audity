<RulesCIS>
  <Rule id="8.1">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>ServerTokens is not set to 'Prod' or 'ProductOnly', which may reveal sensitive server information.</NonCompliantComment>
    <CorrectiveComment>Set ServerTokens to 'Prod' or 'ProductOnly' to minimize information disclosure.</CorrectiveComment>
    <Correction>sed -i 's/^ServerTokens .*/ServerTokens Prod/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^ServerTokens Prod" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="8.2">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>ServerSignature is enabled, potentially revealing sensitive server information.</NonCompliantComment>
    <CorrectiveComment>Disable ServerSignature to prevent information disclosure on error pages.</CorrectiveComment>
    <Correction>sed -i 's/^ServerSignature .*/ServerSignature Off/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^ServerSignature Off" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
  </Rule>
    <Manual>NO</Manual>
  <Rule id="8.3">
    <BasePath>/var/www/html</BasePath>
    <FileName>default_content</FileName>
    <NonCompliantComment>Default Apache content is present, which may reveal server details.</NonCompliantComment>
    <CorrectiveComment>Remove all default Apache content from the DocumentRoot.</CorrectiveComment>
    <Correction>rm -rf /var/www/html/*</Correction>
    <Verification>test -z "$(ls -A /var/www/html)" && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
  <Rule id="8.4">
    <BasePath>/etc/httpd/conf</BasePath>
    <FileName>httpd.conf</FileName>
    <NonCompliantComment>ETag response headers include inode information, potentially leaking filesystem details.</NonCompliantComment>
    <CorrectiveComment>Configure Apache to exclude inode numbers from the ETag header by using only modification time and size.</CorrectiveComment>
    <Correction>sed -i 's/^FileETag .*/FileETag MTime Size/' /etc/httpd/conf/httpd.conf; systemctl restart httpd</Correction>
    <Verification>grep -q "^FileETag MTime Size" /etc/httpd/conf/httpd.conf && echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
</RulesCIS>
