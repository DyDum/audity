<RulesCIS>

    <!-- ═════════ 5  Access Control  →  5.3 Pluggable Authentication Modules ═════════ -->

    <!-- ───────────── 5.3.1  Configure PAM software packages ───────────── -->

    <Rule id="5.3.1.1">
        <Name>Ensure latest version of pam is installed (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.1">Configure PAM software packages</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/usr/bin/</BasePath>
        <FileName>pam</FileName>
        <NonCompliantComment>The PAM package is missing or outdated.</NonCompliantComment>
        <CorrectiveComment>Install or update libpam0g and libpam-modules.</CorrectiveComment>
        <Correction><![CDATA[apt-get update && apt-get install -y libpam0g libpam-modules]]></Correction>
        <Verification><![CDATA[dpkg -l | grep -q libpam0g && dpkg -l | grep -q libpam-modules && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.1.2">
        <Name>Ensure libpam-modules is installed (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.1">Configure PAM software packages</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/usr/bin/</BasePath>
        <FileName>libpam-modules</FileName>
        <NonCompliantComment>libpam-modules is not installed.</NonCompliantComment>
        <CorrectiveComment>Install libpam-modules for full PAM functionality.</CorrectiveComment>
        <Correction><![CDATA[apt-get install -y libpam-modules]]></Correction>
        <Verification><![CDATA[dpkg -l | grep -q libpam-modules && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.1.3">
        <Name>Ensure libpam-pwquality is installed (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.1">Configure PAM software packages</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/usr/bin/</BasePath>
        <FileName>libpam-pwquality</FileName>
        <NonCompliantComment>libpam-pwquality is not installed.</NonCompliantComment>
        <CorrectiveComment>Install libpam-pwquality to enforce password complexity.</CorrectiveComment>
        <Correction><![CDATA[apt-get install -y libpam-pwquality]]></Correction>
        <Verification><![CDATA[dpkg -l | grep -q libpam-pwquality && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>


    <!-- ───────────── 5.3.2  Configure pam-auth-update profiles ───────────── -->

    <Rule id="5.3.2.1">
        <Name>Ensure pam_unix module is enabled (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.2">Configure pam-auth-update profiles</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-auth</FileName>
        <NonCompliantComment>pam_unix is not present in common-auth.</NonCompliantComment>
        <CorrectiveComment>Add "pam_unix.so" to /etc/pam.d/common-auth.</CorrectiveComment>
        <Correction><![CDATA[echo "auth required pam_unix.so" >> /etc/pam.d/common-auth]]></Correction>
        <Verification><![CDATA[grep -q "pam_unix.so" /etc/pam.d/common-auth && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.2.2">
        <Name>Ensure pam_faillock module is enabled (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.2">Configure pam-auth-update profiles</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-auth</FileName>
        <NonCompliantComment>pam_faillock is not configured.</NonCompliantComment>
        <CorrectiveComment>Add pam_faillock with deny=5 unlock_time=900.</CorrectiveComment>
        <Correction><![CDATA[echo "auth required pam_faillock.so preauth silent deny=5 unlock_time=900" >> /etc/pam.d/common-auth]]></Correction>
        <Verification><![CDATA[grep -q "pam_faillock.so" /etc/pam.d/common-auth && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.2.3">
        <Name>Ensure pam_pwquality module is enabled (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.2">Configure pam-auth-update profiles</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>pam_pwquality is not enabled.</NonCompliantComment>
        <CorrectiveComment>Add "pam_pwquality.so retry=3".</CorrectiveComment>
        <Correction><![CDATA[echo "password requisite pam_pwquality.so retry=3" >> /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -q "pam_pwquality.so" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.2.4">
        <Name>Ensure pam_pwhistory module is enabled (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.2">Configure pam-auth-update profiles</SubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>pam_pwhistory is not enabled.</NonCompliantComment>
        <CorrectiveComment>Add "pam_pwhistory.so remember=5 use_authtok".</CorrectiveComment>
        <Correction><![CDATA[echo "password required pam_pwhistory.so remember=5 use_authtok" >> /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -q "pam_pwhistory.so" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>


    <!-- ───────────── 5.3.3  Configure PAM Arguments ───────────── -->

    <!-- 5.3.3.1  Configure pam_faillock module -->

    <Rule id="5.3.3.1.1">
        <Name>Ensure password failed attempts lockout is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.1">Configure pam_faillock module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-auth</FileName>
        <NonCompliantComment>No account lockout configured.</NonCompliantComment>
        <CorrectiveComment>Use pam_faillock deny=5 unlock_time=900.</CorrectiveComment>
        <Correction><![CDATA[echo "auth required pam_faillock.so preauth silent deny=5 unlock_time=900" >> /etc/pam.d/common-auth]]></Correction>
        <Verification><![CDATA[grep -q "pam_faillock.so.*deny=5" /etc/pam.d/common-auth && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.1.2">
        <Name>Ensure password unlock time is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.1">Configure pam_faillock module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-auth</FileName>
        <NonCompliantComment>Unlock time not set for pam_faillock.</NonCompliantComment>
        <CorrectiveComment>Add "unlock_time=900".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_faillock.so/ s/\(unlock_time=\)[0-9]*/unlock_time=900/; /pam_faillock.so/!{s/pam_faillock.so/pam_faillock.so unlock_time=900/}' /etc/pam.d/common-auth]]></Correction>
        <Verification><![CDATA[grep -E "pam_faillock\.so.*unlock_time=900" /etc/pam.d/common-auth && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.1.3">
        <Name>Ensure password failed attempts lockout includes root account (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.1">Configure pam_faillock module</SubSubSection>
        <Profiles>
            <Profile level="2" type="Server"/>
            <Profile level="2" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-auth</FileName>
        <NonCompliantComment>Root account is exempt from faillock.</NonCompliantComment>
        <CorrectiveComment>Add "even_deny_root".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_faillock.so/ s/$/ even_deny_root/' /etc/pam.d/common-auth]]></Correction>
        <Verification><![CDATA[grep -E "pam_faillock\.so.*even_deny_root" /etc/pam.d/common-auth && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>


    <!-- 5.3.3.2  Configure pam_pwquality module -->

    <Rule id="5.3.3.2.1">
        <Name>Ensure password number of changed characters is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>difok (number of changed characters) is not enforced.</NonCompliantComment>
        <CorrectiveComment>Set "difok=4".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/\(difok=\)[0-9]*/difok=4/; /pam_pwquality.so/!{s/pam_pwquality.so/pam_pwquality.so difok=4/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*difok=4" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.2.2">
        <Name>Ensure minimum password length is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Minimum password length not enforced.</NonCompliantComment>
        <CorrectiveComment>Set "minlen=12".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/\(minlen=\)[0-9]*/minlen=12/; /pam_pwquality.so/!{s/pam_pwquality.so/pam_pwquality.so minlen=12/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*minlen=12" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.2.3">
        <Name>Ensure password complexity is configured (Manual)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Complexity credits not defined.</NonCompliantComment>
        <CorrectiveComment>Define dcredit, ucredit, ocredit, lcredit.</CorrectiveComment>
        <Correction><![CDATA[echo "Manual configuration required: add dcredit ucredit ocredit lcredit." ]]></Correction>
        <Verification><![CDATA[echo "Manual verification required"]]></Verification>
        <Manual>YES</Manual>
    </Rule>

    <Rule id="5.3.3.2.4">
        <Name>Ensure password same consecutive characters is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>No limit on repeating characters.</NonCompliantComment>
        <CorrectiveComment>Set "maxrepeat=3".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/\(maxrepeat=\)[0-9]*/maxrepeat=3/; /pam_pwquality.so/!{s/pam_pwquality.so/pam_pwquality.so maxrepeat=3/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*maxrepeat=3" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.2.5">
        <Name>Ensure password maximum sequential characters is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>No limit on sequential characters.</NonCompliantComment>
        <CorrectiveComment>Set "maxsequence=3".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/\(maxsequence=\)[0-9]*/maxsequence=3/; /pam_pwquality.so/!{s/pam_pwquality.so/pam_pwquality.so maxsequence=3/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*maxsequence=3" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.2.6">
        <Name>Ensure password dictionary check is enabled (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Dictionary checking disabled.</NonCompliantComment>
        <CorrectiveComment>Set "dictcheck=1".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/\(dictcheck=\)[0-9]*/dictcheck=1/; /pam_pwquality.so/!{s/pam_pwquality.so/pam_pwquality.so dictcheck=1/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*dictcheck=1" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.2.7">
        <Name>Ensure password quality checking is enforced for the root user (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.2">Configure pam_pwquality module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Root password exempt from quality checks.</NonCompliantComment>
        <CorrectiveComment>Add "enforce_for_root".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwquality.so/ s/$/ enforce_for_root/' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwquality\.so.*enforce_for_root" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>


    <!-- 5.3.3.3  Configure pam_pwhistory module -->

    <Rule id="5.3.3.3.1">
        <Name>Ensure password history remember is configured (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.3">Configure pam_pwhistory module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Password reuse not restricted.</NonCompliantComment>
        <CorrectiveComment>Set "remember=5".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwhistory.so/ s/remember=[0-9]*/remember=5/; /pam_pwhistory.so/!{s/pam_pwhistory.so/pam_pwhistory.so remember=5/}' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwhistory\.so.*remember=5" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.3.2">
        <Name>Ensure password history is enforced for the root user (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.3">Configure pam_pwhistory module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>Root can reuse old passwords.</NonCompliantComment>
        <CorrectiveComment>Add "enforce_for_root".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwhistory.so/ s/$/ enforce_for_root/' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwhistory\.so.*enforce_for_root" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.3.3">
        <Name>Ensure pam_pwhistory includes use_authtok (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.3">Configure pam_pwhistory module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>use_authtok missing.</NonCompliantComment>
        <CorrectiveComment>Add "use_authtok".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_pwhistory.so/ s/$/ use_authtok/' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep -E "pam_pwhistory\.so.*use_authtok" /etc/pam.d/common-password && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>


    <!-- 5.3.3.4  Configure pam_unix module (règles déjà fournies) -->

    <Rule id="5.3.3.4.1">
        <Name>Ensure pam_unix does not include nullok (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.4">Configure pam_unix module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>"nullok" allows empty passwords.</NonCompliantComment>
        <CorrectiveComment>Remove "nullok".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_unix.so/ s/nullok//' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep "pam_unix.so" /etc/pam.d/common-password | grep -q nullok && echo 1 || echo 0]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.4.2">
        <Name>Ensure pam_unix does not include remember (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.4">Configure pam_unix module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>"remember=" handled by pam_pwhistory.</NonCompliantComment>
        <CorrectiveComment>Remove "remember=".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_unix.so/ s/remember=[0-9]*//' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep "pam_unix.so" /etc/pam.d/common-password | grep -q "remember=" && echo 1 || echo 0]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.4.3">
        <Name>Ensure pam_unix includes a strong password hashing algorithm (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.4">Configure pam_unix module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>No explicit hashing algorithm set.</NonCompliantComment>
        <CorrectiveComment>Add "sha512".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_unix.so/ { /sha512/! s/$/ sha512/ }' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep "pam_unix.so" /etc/pam.d/common-password | grep -q sha512 && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="5.3.3.4.4">
        <Name>Ensure pam_unix includes use_authtok (Automated)</Name>
        <Chapter id="5">Access Control</Chapter>
        <Section id="5.3">Pluggable Authentication Modules</Section>
        <SubSection id="5.3.3">Configure PAM Arguments</SubSection>
        <SubSubSection id="5.3.3.4">Configure pam_unix module</SubSubSection>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/pam.d/</BasePath>
        <FileName>common-password</FileName>
        <NonCompliantComment>use_authtok missing.</NonCompliantComment>
        <CorrectiveComment>Add "use_authtok".</CorrectiveComment>
        <Correction><![CDATA[sed -i '/pam_unix.so/ s/$/ use_authtok/' /etc/pam.d/common-password]]></Correction>
        <Verification><![CDATA[grep "pam_unix.so" /etc/pam.d/common-password | grep -q use_authtok && echo 0 || echo 1]]></Verification>
        <Manual>NO</Manual>
    </Rule>

</RulesCIS>