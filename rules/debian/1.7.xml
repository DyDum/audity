<RulesCIS>
    <Rule id="1.7.1">
        <Name>Ensure GDM is removed (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="2" type="Server"/>
        </Profiles>
        <BasePath>/usr/sbin/</BasePath>
        <FileName>gdm3</FileName>
        <NonCompliantComment>GDM is installed on the system, which may allow unauthorized graphical logins.</NonCompliantComment>
        <CorrectiveComment>Remove the GDM package to disable the graphical login manager.</CorrectiveComment>
        <Correction>apt-get purge -y gdm3</Correction>
        <Verification>dpkg -l | grep -q gdm3 &amp;&amp; echo 1 || echo 0</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.2">
        <Name>Ensure GDM login banner is configured (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>The GDM login banner is not configured, leaving users without a proper warning.</NonCompliantComment>
        <CorrectiveComment>Configure a login banner in /etc/gdm3/custom.conf to display an appropriate message.</CorrectiveComment>
        <Correction>echo "[org/gnome/login-screen]" &gt; /etc/gdm3/custom.conf; echo "banner-message-enable=true" &gt;&gt; /etc/gdm3/custom.conf; echo "banner-message-text='Authorized Access Only'" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "banner-message-enable=true" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.3">
        <Name>Ensure GDM disable-user-list option is enabled (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>The GDM user list is not disabled, potentially exposing local user information.</NonCompliantComment>
        <CorrectiveComment>Disable the user list in GDM by setting the disable-user-list option to true.</CorrectiveComment>
        <Correction>echo "[org/gnome/login-screen]" &gt; /etc/gdm3/custom.conf; echo "disable-user-list=true" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "disable-user-list=true" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.4">
        <Name>Ensure GDM screen locks when the user is idle (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>GDM is not configured to lock the screen when idle, which may allow unauthorized access.</NonCompliantComment>
        <CorrectiveComment>Configure GDM to automatically lock the screen when the user is idle.</CorrectiveComment>
        <Correction>echo "[org/gnome/desktop/screensaver]" &gt; /etc/gdm3/custom.conf; echo "lock-enabled=true" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "lock-enabled=true" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.5">
        <Name>Ensure GDM screen locks cannot be overridden (Manual)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>The GDM screen lock settings may be overridden by users.</NonCompliantComment>
        <CorrectiveComment>Enforce screen lock settings in GDM so that they cannot be overridden.</CorrectiveComment>
        <Correction>(Manual enforcement required: review and lock down the settings via policy)</Correction>
        <Verification>echo "Manual review required"</Verification>
        <Manual>YES</Manual>
    </Rule>

    <Rule id="1.7.6">
        <Name>Ensure GDM automatic mounting of removable media is disabled (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="2" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>Automatic mounting of removable media is enabled in GDM.</NonCompliantComment>
        <CorrectiveComment>Disable automatic mounting of removable media in GDM.</CorrectiveComment>
        <Correction>echo "[org/gnome/settings-daemon/plugins/media-keys]" &gt; /etc/gdm3/custom.conf; echo "automount=false" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "automount=false" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.7">
        <Name>Ensure GDM disabling automatic mounting of removable media is not overridden (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="2" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>The setting to disable automatic mounting of removable media might be overridden.</NonCompliantComment>
        <CorrectiveComment>Ensure that the disable setting for automount is enforced in GDM.</CorrectiveComment>
        <Correction>echo "[org/gnome/settings-daemon/plugins/media-keys]" &gt; /etc/gdm3/custom.conf; echo "automount=false" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "automount=false" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.8">
        <Name>Ensure GDM autorun-never is enabled (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>GDM is not configured to disable autorun, potentially exposing the system.</NonCompliantComment>
        <CorrectiveComment>Enable the autorun-never option in GDM.</CorrectiveComment>
        <Correction>echo "[org/gnome/settings-daemon/plugins/media-keys]" &gt; /etc/gdm3/custom.conf; echo "autorun-never=true" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "autorun-never=true" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.9">
        <Name>Ensure GDM autorun-never option cannot be overridden (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>custom.conf</FileName>
        <NonCompliantComment>The autorun-never setting in GDM is not enforced.</NonCompliantComment>
        <CorrectiveComment>Ensure the autorun-never option remains enabled and cannot be overridden.</CorrectiveComment>
        <Correction>echo "[org/gnome/settings-daemon/plugins/media-keys]" &gt; /etc/gdm3/custom.conf; echo "autorun-never=true" &gt;&gt; /etc/gdm3/custom.conf</Correction>
        <Verification>grep -q "autorun-never=true" /etc/gdm3/custom.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>

    <Rule id="1.7.10">
        <Name>Ensure XDMCP is not enabled (Automated)</Name>
        <Chapter id="1">Initial Setup</Chapter>
        <Section id="1.7">Configure GNOME Display Manager</Section>
        <Profiles>
            <Profile level="1" type="Server"/>
            <Profile level="1" type="Workstation"/>
        </Profiles>
        <BasePath>/etc/gdm3/</BasePath>
        <FileName>daemon.conf</FileName>
        <NonCompliantComment>XDMCP is enabled, potentially exposing the system to remote graphical logins.</NonCompliantComment>
        <CorrectiveComment>Disable XDMCP in GDM to secure remote access.</CorrectiveComment>
        <Correction>echo "[xdmcp]" &gt; /etc/gdm3/daemon.conf; echo "Enable=false" &gt;&gt; /etc/gdm3/daemon.conf; systemctl restart gdm3</Correction>
        <Verification>grep -q "Enable=false" /etc/gdm3/daemon.conf &amp;&amp; echo 0 || echo 1</Verification>
        <Manual>NO</Manual>
    </Rule>
</RulesCIS>
