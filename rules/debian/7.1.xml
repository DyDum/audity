<RulesCIS>

  <!-- ═════════ 7  System Maintenance  →  7.1 System File Permissions ═════════ -->

  <Rule id="7.1.1">
    <Name>Ensure permissions on /etc/passwd are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>passwd</FileName>
    <NonCompliantComment>/etc/passwd permissions are not 644, risking unauthorized access.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 644.</CorrectiveComment>
    <Correction>chmod 644 /etc/passwd</Correction>
    <Verification>stat -c "%a" /etc/passwd | grep -q "^644$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.2">
    <Name>Ensure permissions on /etc/passwd- are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>passwd-</FileName>
    <NonCompliantComment>/etc/passwd- permissions are too permissive.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 640.</CorrectiveComment>
    <Correction>chmod 640 /etc/passwd-</Correction>
    <Verification>stat -c "%a" /etc/passwd- | grep -q "^640$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.3">
    <Name>Ensure permissions on /etc/group are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>group</FileName>
    <NonCompliantComment>/etc/group permissions are not 644.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 644.</CorrectiveComment>
    <Correction>chmod 644 /etc/group</Correction>
    <Verification>stat -c "%a" /etc/group | grep -q "^644$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.4">
    <Name>Ensure permissions on /etc/group- are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>group-</FileName>
    <NonCompliantComment>/etc/group- permissions are too permissive.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 640.</CorrectiveComment>
    <Correction>chmod 640 /etc/group-</Correction>
    <Verification>stat -c "%a" /etc/group- | grep -q "^640$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.5">
    <Name>Ensure permissions on /etc/shadow are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>shadow</FileName>
    <NonCompliantComment>/etc/shadow permissions are not 600, exposing password hashes.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 600.</CorrectiveComment>
    <Correction>chmod 600 /etc/shadow</Correction>
    <Verification>stat -c "%a" /etc/shadow | grep -q "^600$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.6">
    <Name>Ensure permissions on /etc/shadow- are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>shadow-</FileName>
    <NonCompliantComment>/etc/shadow- permissions are too permissive.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 640.</CorrectiveComment>
    <Correction>chmod 640 /etc/shadow-</Correction>
    <Verification>stat -c "%a" /etc/shadow- | grep -q "^640$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.7">
    <Name>Ensure permissions on /etc/gshadow are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>gshadow</FileName>
    <NonCompliantComment>/etc/gshadow permissions are not 600.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 600.</CorrectiveComment>
    <Correction>chmod 600 /etc/gshadow</Correction>
    <Verification>stat -c "%a" /etc/gshadow | grep -q "^600$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.8">
    <Name>Ensure permissions on /etc/gshadow- are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>gshadow-</FileName>
    <NonCompliantComment>/etc/gshadow- permissions are too permissive.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 640.</CorrectiveComment>
    <Correction>chmod 640 /etc/gshadow-</Correction>
    <Verification>stat -c "%a" /etc/gshadow- | grep -q "^640$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.9">
    <Name>Ensure permissions on /etc/shells are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/</BasePath>
    <FileName>shells</FileName>
    <NonCompliantComment>/etc/shells permissions are too permissive.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 644.</CorrectiveComment>
    <Correction>chmod 644 /etc/shells</Correction>
    <Verification>stat -c "%a" /etc/shells | grep -q "^644$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.10">
    <Name>Ensure permissions on /etc/security/opasswd are configured (Automated)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/etc/security/</BasePath>
    <FileName>opasswd</FileName>
    <NonCompliantComment>/etc/security/opasswd permissions are not 600.</NonCompliantComment>
    <CorrectiveComment>Set file mode to 600.</CorrectiveComment>
    <Correction>chmod 600 /etc/security/opasswd</Correction>
    <Verification>stat -c "%a" /etc/security/opasswd | grep -q "^600$" &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="7.1.11">
    <Name>Ensure world writable files and directories are secured (Manual)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/</BasePath>
    <FileName>world_writable</FileName>
    <NonCompliantComment>World-writable objects can be modified by any user.</NonCompliantComment>
    <CorrectiveComment>Identify and remediate world-writable files/directories.</CorrectiveComment>
    <Correction>echo "Manual review: find / -xdev -type f -perm -0002"</Correction>
    <Verification>echo "Manual verification required"</Verification>
    <Manual>YES</Manual>
  </Rule>

  <Rule id="7.1.12">
    <Name>Ensure no files or directories without an owner and a group exist (Manual)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/</BasePath>
    <FileName>orphan_files</FileName>
    <NonCompliantComment>Unowned files may be appropriated by attackers.</NonCompliantComment>
    <CorrectiveComment>Find and re-assign or remove orphan files.</CorrectiveComment>
    <Correction>echo "Manual review: find / -xdev \\( -nouser -o -nogroup \\)"</Correction>
    <Verification>echo "Manual verification required"</Verification>
    <Manual>YES</Manual>
  </Rule>

  <Rule id="7.1.13">
    <Name>Ensure SUID and SGID files are reviewed (Manual)</Name>
    <Chapter id="7">System Maintenance</Chapter>
    <Section id="7.1">System File Permissions</Section>
    <Profiles>
      <Profile level="1" type="Server"/>
      <Profile level="1" type="Workstation"/>
    </Profiles>
    <BasePath>/</BasePath>
    <FileName>suid_sgid_review</FileName>
    <NonCompliantComment>Unreviewed SUID/SGID files can enable privilege escalation.</NonCompliantComment>
    <CorrectiveComment>Regularly audit all SUID/SGID binaries.</CorrectiveComment>
    <Correction>echo "Manual review: find / -xdev -perm /6000 -type f -exec ls -la {} \\;"</Correction>
    <Verification>echo "Manual verification required"</Verification>
    <Manual>YES</Manual>
  </Rule>

</RulesCIS>
