<ReglesCIS>
  <Regle id="1.1.1">
    <CheminBase>/etc/nginx/</CheminBase>
    <NomFichier>N/A</NomFichier>
    <RegleNonConforme>NGINX is not installed, which means the server is not secured with a recommended web server.</RegleNonConforme>
    <RegleCorrigee>Install NGINX using the package manager or from source to ensure a secure installation.</RegleCorrigee>
    <Correction>dnf install nginx -y</Correction>
    <Verification>nginx -v &amp;&amp; echo 0 || echo 1</Verification>
  </Regle>

  <Regle id="1.1.2">
    <CheminBase>/etc/nginx/</CheminBase>
    <NomFichier>N/A</NomFichier>
    <RegleNonConforme>NGINX is not installed from source, which may include unnecessary modules and increase the attack surface.</RegleNonConforme>
    <RegleCorrigee>Install NGINX from source with only the necessary modules enabled.</RegleCorrigee>
    <Correction>wget https://nginx.org/download/nginx-1.22.0.tar.gz; tar -zxvf nginx-1.22.0.tar.gz; cd nginx-1.22.0; ./configure --without-http_autoindex_module --without-http_gzip_module; make; make install</Correction>
    <Verification>nginx -V 2>&amp;1 | grep -q 'built from source' &amp;&amp; echo 0 || echo 1</Verification>
  </Regle>

  <Regle id="1.2.1">
    <CheminBase>/etc/yum.repos.d/</CheminBase>
    <NomFichier>nginx.repo</NomFichier>
    <RegleNonConforme>NGINX package repositories are not properly configured, which may prevent updates.</RegleNonConforme>
    <RegleCorrigee>Configure the NGINX repository in the package manager for automatic updates.</RegleCorrigee>
    <Correction>echo -e "[nginx-stable]\nname=nginx stable repo\nbaseurl=http://nginx.org/packages/rhel/8/\$basearch/\ngpgcheck=1\nenabled=1\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true" > /etc/yum.repos.d/nginx.repo</Correction>
    <Verification>dnf repolist -v nginx-stable | grep -q 'nginx-stable' &amp;&amp; echo 0 || echo 1</Verification>
  </Regle>

  <Regle id="1.2.2">
    <CheminBase>/usr/sbin/</CheminBase>
    <NomFichier>nginx</NomFichier>
    <RegleNonConforme>NGINX is not updated to the latest version, which may contain security vulnerabilities.</RegleNonConforme>
    <RegleCorrigee>Update NGINX to the latest version using the package manager.</RegleCorrigee>
    <Correction>dnf update nginx -y</Correction>
    <Verification>nginx -v | grep -q '1.22.0' &amp;&amp; echo 0 || echo 1</Verification>
  </Regle>
</ReglesCIS>
