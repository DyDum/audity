<RulesCIS>
  <Rule id="1.1">
    <BasePath>$CATALINA_HOME/webapps/</BasePath>
    <FileName>extraneous files and directories</FileName>
    <NonCompliantComment>Extraneous files and directories (e.g., examples, docs, ROOT, manager, host-manager) exist in the Tomcat webapps directory, which may introduce security risks.</NonCompliantComment>
    <CorrectiveComment>Remove extraneous files and directories to reduce the attack surface. Command: rm -rf $CATALINA_HOME/webapps/docs $CATALINA_HOME/webapps/examples $CATALINA_HOME/webapps/ROOT</CorrectiveComment>
    <Correction>rm -rf $CATALINA_HOME/webapps/docs $CATALINA_HOME/webapps/examples $CATALINA_HOME/webapps/ROOT</Correction>
    <Verification>ls -l $CATALINA_HOME/webapps | grep -E 'docs|examples|ROOT|manager|host-manager' &amp;&amp; echo 1 || echo 0</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="1.2">
    <BasePath>$CATALINA_HOME/conf/</BasePath>
    <FileName>server.xml</FileName>
    <NonCompliantComment>Unused connectors are enabled, which may expose the server to unnecessary security risks.</NonCompliantComment>
    <CorrectiveComment>Disable unused connectors in the Tomcat server.xml file. Command: Comment out or remove the unused <Connector> elements.</CorrectiveComment>
    <Correction>sed -i '/<Connector/,/<\/Connector>/s/^/<!--/; /<\/Connector>/s/$/-->/' $CATALINA_HOME/conf/server.xml</Correction>
    <Verification>grep -E '<!--.*<Connector.*-->' $CATALINA_HOME/conf/server.xml &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
</RulesCIS>
