<RulesCIS>
  <Rule id="9.1">
    <BasePath>$CATALINA_HOME/conf/</BasePath>
    <FileName>context.xml</FileName>
    <NonCompliantComment>Auto deployment of applications is enabled, which may allow unauthorized applications to be deployed automatically.</NonCompliantComment>
    <CorrectiveComment>Disable auto deployment of applications. Command: 
    1. Open the context.xml file in a text editor. 
    2. Locate the <Context> element. 
    3. Set the following attributes: 
       deployOnStartup="false" 
       autoDeploy="false" 
    4. Save the file and restart Tomcat using systemctl restart tomcat.</CorrectiveComment>
    <Correction>sed -i '/<Context/s/deployOnStartup=".*"/deployOnStartup="false"/' $CATALINA_HOME/conf/context.xml; sed -i '/<Context/s/autoDeploy=".*"/autoDeploy="false"/' $CATALINA_HOME/conf/context.xml; systemctl restart tomcat</Correction>
    <Verification>grep '<Context.*deployOnStartup="false".*autoDeploy="false"' $CATALINA_HOME/conf/context.xml &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>

  <Rule id="9.2">
    <BasePath>$CATALINA_HOME/conf/</BasePath>
    <FileName>context.xml</FileName>
    <NonCompliantComment>Deploy on startup of applications is enabled, which may allow unauthorized applications to be deployed automatically on server startup.</NonCompliantComment>
    <CorrectiveComment>Disable deploy on startup of applications. Command: 
    1. Open the context.xml file in a text editor. 
    2. Locate the <Context> element. 
    3. Set the following attributes: 
       deployOnStartup="false" 
    4. Save the file and restart Tomcat using systemctl restart tomcat.</CorrectiveComment>
    <Correction>sed -i '/<Context/s/deployOnStartup=".*"/deployOnStartup="false"/' $CATALINA_HOME/conf/context.xml; systemctl restart tomcat</Correction>
    <Verification>grep '<Context.*deployOnStartup="false"' $CATALINA_HOME/conf/context.xml &amp;&amp; echo 0 || echo 1</Verification>
    <Manual>NO</Manual>
  </Rule>
</RulesCIS>
